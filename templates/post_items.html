<div class="bg-white rounded-xl shadow-sm p-4 hover:shadow-md transition">
  <a href="{% url 'post_detail' post.slug %}">
    <h3 class="text-lg font-semibold hover:text-blue-600">{{ post.title }}</h3>
  </a>
  <p class="text-gray-700 mt-1">{{ post.body }}</p>

  <div class="flex justify-between items-center text-sm text-gray-500 mt-3">
    <a href="{% url 'profile_user' post.author.username %}" class="hover:text-blue-600">@{{ post.author.username }}</a>
    <div class="flex items-center space-x-3">
      <!-- ❤️ Like icon -->
      <button class="like-btn flex items-center space-x-1 focus:outline-none" data-slug="{{ post.slug }}">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"
            fill="{% if user in post.likes.all %}red{% else %}none{% endif %}"
            stroke="currentColor" stroke-width="1.5"
            class="w-5 h-5 {% if user in post.likes.all %}text-red-500{% else %}text-gray-400{% endif %} transition-colors duration-200">
          <path stroke-linecap="round" stroke-linejoin="round"
                d="M12 21s-6.938-4.313-9.125-8.438C1.094 9.438 3.563 5.25 7.5 5.25c1.875 0 3.469.938 4.5 2.344C13.031 6.188 14.625 5.25 16.5 5.25c3.938 0 6.406 4.188 4.625 7.313C18.938 16.688 12 21 12 21z"/>
        </svg>
        <span class="like-count text-xs">{{ post.likes.count }}</span>
      </button>

      <a href="{% url 'post_reply' post.slug %}" class="reply-btn flex items-center space-x-1 text-gray-500 hover:text-blue-600">
        <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5">
          <path stroke-linecap="round" stroke-linejoin="round" d="M8 10h.01M12 10h.01M16 10h.01M21 12c0 4.418-4.03 8-9 8-1.76 0-3.41-.486-4.78-1.32L3 20l1.32-4.22A8.959 8.959 0 0 1 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"/>
        </svg>
        <span class="text-xs">Reply</span>
      </a>

      <!-- Sana -->
      <span class="text-gray-500">{{ post.created_at|date:"d M Y, H:i" }}</span>
    </div>
  </div>
</div>


<script>
document.addEventListener("DOMContentLoaded", function() {
  const csrftoken = document.querySelector('[name=csrfmiddlewaretoken]').value;
  const panel = document.getElementById('comment-panel');
  const panelContent = document.getElementById('comment-panel-content');
  const closeBtn = document.getElementById('close-comment-panel');

  // Like button
  document.querySelectorAll('.like-btn').forEach(btn => {
    btn.addEventListener('click', function() {
      const slug = this.dataset.slug;
      const icon = this.querySelector('svg');
      const likeCount = this.querySelector('.like-count');

      fetch("{% url 'toggle_like' %}", {
        method: "POST",
        headers: {
          "Content-Type": "application/x-www-form-urlencoded",
          "X-CSRFToken": csrftoken,
        },
        body: `slug=${slug}`
      })
      .then(res => res.json())
      .then(data => {
        if (data.liked) {
          icon.classList.remove('text-gray-400');
          icon.classList.add('text-red-500', 'fill-red-500');
        } else {
          icon.classList.remove('text-red-500', 'fill-red-500');
          icon.classList.add('text-gray-400');
        }
        likeCount.textContent = data.total_likes;
      });
    });
  });
});
</script>



